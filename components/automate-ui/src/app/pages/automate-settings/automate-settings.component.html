<div class="content-container">
  <div class="container">
    <main>
      <chef-notification
        *ngIf="notificationVisible"
        [type]="notificationType"
        [timeout]="notificationTimeout()"
        (dismissed)="hideNotification()">
        {{ notificationMessage }}
      </chef-notification>

      <chef-page-header>
        <chef-heading>Data Lifecycle</chef-heading>
        <chef-subheading>Manage the retention of events, service groups, Chef Client runs, compliance reports and scans in Chef Automate.</chef-subheading>
      </chef-page-header>

      <div class="page-body">

        <div class="group-section">
          <chef-button primary [disabled]="noChanges()" (click)="applyChanges()">Save Changes</chef-button>
          <chef-button secondary [disabled]="noChanges()" (click)="testPrintValues()">Print Values</chef-button>
        </div>

        <div class="group-section" [formGroup]="eventFeedForm">
          <h2>Event Feed</h2>
          <div class="checkbox-row" formGroupName="feedData">
            <div class="checkbox-container">
              <chef-checkbox
              [checked]="!eventFeedForm.controls.disabled.controls.feedData.value"
              (change)="toggleInput(eventFeedForm, 'feedData', $event.detail)">
            </chef-checkbox>
            </div>
              <p>Remove event feed data after
                <input chefInput type="number" formControlName="threshold" />days</p>
          </div>

          <div class="checkbox-row" formGroupName="serverActions">
            <div class="checkbox-container">
              <chef-checkbox
                [checked]="!eventFeedForm.controls.disabled.controls.serverActions.value"
                (change)="toggleInput(eventFeedForm, 'serverActions', $event.detail)">
              </chef-checkbox>
            </div>
            <p>Remove Chef Server actions after<input chefInput type="number" formControlName="threshold" />days</p>
          </div>
        </div>

        <div class="group-section" [formGroup]="serviceGroupForm">
          <h2>Service Groups</h2>
          <div class="checkbox-row" formGroupName="healthChecks">
            <div class="checkbox-container">
              <chef-checkbox
              [checked]="!serviceGroupForm.controls.disabled.controls.healthChecks.value"
              (change)="toggleInput(serviceGroupForm, 'healthChecks', $event.detail)">
              </chef-checkbox>
            </div>

            <p>When no health check reports have been received for a service in
              <input chefInput type="number" formControlName="threshold" />
              <mat-form-field appearance="none">
                <mat-select panelClass="chef-dropdown" formControlName="unit">
                  <mat-option value="m">minutes</mat-option>
                  <mat-option value="h">hours</mat-option>
                  <mat-option value="d">days</mat-option>
                </mat-select>
              </mat-form-field>
              , label the service as disconnected</p>
          </div>
          
          <div class="checkbox-row secondary-row" formGroupName="removeServices">
            <div class="checkbox-container">
              <chef-checkbox
              [checked]="!serviceGroupForm.controls.disabled.controls.removeServices.value"
              (change)="toggleInput(serviceGroupForm, 'removeServices', $event.detail)">
              </chef-checkbox>
            </div>
            <p>Remove services labeled as disconnected after
              <input chefInput type="number" formControlName="threshold" />
              <mat-form-field appearance="none">
                <mat-select panelClass="chef-dropdown" formControlName="unit">
                  <mat-option value="m">minutes</mat-option>
                  <mat-option value="h">hours</mat-option>
                  <mat-option value="d">days</mat-option>
                </mat-select>
              </mat-form-field>
            </p>
          </div>
        </div>

        <div class="group-section" [formGroup]="clientRunsForm">
          <h2>Client Runs</h2>
          <div class="checkbox-row" formGroupName="removeData">
            <div class="checkbox-container">
              <chef-checkbox
              [checked]="!clientRunsForm.controls.disabled.controls.removeData.value"
              (change)="toggleInput(clientRunsForm, 'removeData', $event.detail)">
              </chef-checkbox>
            </div>
            <p>Remove data for Chef Client runs after<input chefInput type="number" formControlName="threshold" />days</p>
          </div>

          <div class="checkbox-row" formGroupName="labelMissing">
            <div class="checkbox-container">
              <chef-checkbox
              [checked]="!clientRunsForm.controls.disabled.controls.labelMissing.value"
              (change)="toggleInput(clientRunsForm, 'labelMissing', $event.detail)">
              </chef-checkbox>
            </div>
          
            <p>When no Chef Client run data has been received from a node in
              <input chefInput type="number" formControlName="threshold" />
              <mat-form-field appearance="none">
                <mat-select panelClass="chef-dropdown" formControlName="unit">
                  <mat-option value="m">minutes</mat-option>
                  <mat-option value="h">hours</mat-option>
                  <mat-option value="d">days</mat-option>
                </mat-select>
              </mat-form-field>
              , label the node as missing
            </p>
          </div>

          <div class="checkbox-row secondary-row" formGroupName="removeMissing">
            <div class="checkbox-container">
              <chef-checkbox
              [checked]="!clientRunsForm.controls.disabled.controls.removeMissing.value"
              (change)="toggleInput(clientRunsForm, 'removeMissing', $event.detail)">
              </chef-checkbox>
            </div>
            <p>Remove nodes labeled as missing after<input chefInput type="number" formControlName="threshold" />
            <mat-form-field appearance="none">
              <mat-select panelClass="chef-dropdown" formControlName="unit">
                <mat-option value="m">minutes</mat-option>
                <mat-option value="h">hours</mat-option>
                <mat-option value="d">days</mat-option>
              </mat-select>
            </mat-form-field>
            </p>
          </div>
        </div>

        <div class="group-section" [formGroup]="complianceDataForm">
          <h2>Compliance</h2>
          <div class="checkbox-row" formGroupName="reports">
            <div class="checkbox-container">
              <chef-checkbox
              [checked]="!complianceDataForm.controls.disabled.controls.reports.value"
              (change)="toggleInput(complianceDataForm, 'reports', $event.detail)">
              </chef-checkbox>
            </div>
            <p>Remove compliance reports after<input chefInput type="number" formControlName="threshold" />days</p>
          </div>

          <div class="checkbox-row" formGroupName="scans">
            <div class="checkbox-container">
              <chef-checkbox
              [checked]="!complianceDataForm.controls.disabled.controls.scans.value"
              (change)="toggleInput(complianceDataForm, 'scans', $event.detail)">
              </chef-checkbox>
            </div>
            <p>Remove compliance scans after<input chefInput type="number" formControlName="threshold" />days</p>
          </div>
        </div>

      </div>
    </main>
  </div>
</div>
